<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TypeMaster || Typing Speed Test</title>
    <!-- Firebase App and Auth SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="topographic-bg"></div>
    <div id="confetti-canvas"></div>

    <!-- Notification System -->
    <div class="modal-overlay" id="notification-modal">
        <div class="modal">
            <div class="modal-body">
                <p id="notification-message"></p>
            </div>
            <div class="modal-footer">
                <button id="close-notification" tabindex="-1">OK</button>
            </div>
        </div>
    </div>

    <!-- Tutorial Modal -->
    <div class="modal-overlay tutorial-modal" id="tutorial-modal">
        <div class="modal">
            <div class="modal-header">
                <h2>Welcome to TypeMaster! ðŸŽ‰</h2>
            </div>
            <div class="modal-body">
                <div class="tutorial-steps">
                    <div class="tutorial-step">
                        <h3>Step 1: Choose Your Mode</h3>
                        <p>Select between Timed Test or Survival Mode</p>
                    </div>
                    <div class="tutorial-step">
                        <h3>Step 2: Adjust Settings</h3>
                        <p>Customize duration, difficulty, and language</p>
                    </div>
                    <div class="tutorial-step">
                        <h3>Step 3: Start Typing</h3>
                        <p>Click the input field and begin typing the words</p>
                    </div>
                    <div class="tutorial-step">
                        <h3>Step 4: Review Results</h3>
                        <p>Get detailed analysis of your performance</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="close-tutorial" tabindex="-1">Get Started</button>
            </div>
        </div>
    </div>

    <div class="container">
        <header>
            <h1>TypeMaster</h1>
            <div class="controls">
                <div class="user-status" id="user-status">
                    <div class="user-avatar" id="user-avatar">?</div>
                    <span class="user-name" id="user-name-display">Guest</span>
                    <button id="login-btn" tabindex="-1">Login</button>
                    <button id="logout-btn" style="display: none; width: 150px" tabindex="-1">
                        Logout
                    </button>
                </div>
                <button class="theme-toggle" id="theme-toggle" tabindex="-1">
                    ðŸŒ™
                </button>
            </div>
        </header>

        <div class="settings-panel">
            <div class="game-mode-selector">
                <div class="game-mode-btn active" data-mode="timed" tabindex="-1">
                    Timed Test
                </div>
                <div class="game-mode-btn" data-mode="survival" tabindex="-1">
                    Survival Mode
                </div>
                <div class="game-mode-btn" data-mode="practice" tabindex="-1">
                    AI Practice
                </div>
                <div class="game-mode-btn" data-mode="prediction" tabindex="-1">
                    Prediction Challenge
                </div>
            </div>

            <div class="mode-settings active" id="timed-settings">
                <div class="settings-grid">
                    <div class="setting-group">
                        <label for="time-select">Test Duration</label>
                        <select id="time-select" tabindex="-1">
                            <option value="30">30 Seconds</option>
                            <option value="60" selected>60 Seconds</option>
                            <option value="120">2 Minutes</option>
                            <option value="300">5 Minutes</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>

                    <div class="setting-group" id="custom-time-group" style="display: none">
                        <label for="custom-time">Custom Time (seconds)</label>
                        <input type="number" id="custom-time" min="10" max="600" value="60" tabindex="-1" />
                    </div>

                    <div class="setting-group">
                        <label for="difficulty-select">Difficulty</label>
                        <select id="difficulty-select" tabindex="-1">
                            <option value="easy" selected>Easy</option>
                            <option value="medium">Medium</option>
                            <option value="hard">Hard</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label for="language-select">Language</label>
                        <select id="language-select" tabindex="-1">
                            <option value="english" selected>English</option>
                            <option value="bangla">Bangla</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label for="punctuation-toggle">Punctuation & Capitals</label>
                        <select id="punctuation-toggle" tabindex="-1">
                            <option value="enabled">Enabled</option>
                            <option value="disabled" selected>Disabled</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label for="sound-select">Keyboard Sound</label>
                        <select id="sound-select" tabindex="-1">
                            <option value="none">None</option>
                            <option value="mechanical">Mechanical</option>
                            <option value="typewriter">Typewriter</option>
                            <option value="asmr">ASMR</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="mode-settings" id="survival-settings">
                <div class="settings-grid">
                    <div class="setting-group">
                        <label for="survival-type">End Condition</label>
                        <select id="survival-type" tabindex="-1">
                            <option value="mistakes" selected>Max Mistakes</option>
                            <option value="time">Time Limit</option>
                        </select>
                    </div>

                    <div class="setting-group" id="max-mistakes-group">
                        <label for="max-mistakes">Maximum Mistakes</label>
                        <input type="number" id="max-mistakes" min="1" max="50" value="5" tabindex="-1" />
                    </div>

                    <div class="setting-group" id="survival-time-group" style="display: none">
                        <label for="survival-time">Time Limit (minutes)</label>
                        <input type="number" id="survival-time" min="1" max="60" value="5" tabindex="-1" />
                    </div>

                    <div class="setting-group">
                        <label for="survival-difficulty">Difficulty</label>
                        <select id="survival-difficulty" tabindex="-1">
                            <option value="easy" selected>Easy</option>
                            <option value="medium">Medium</option>
                            <option value="hard">Hard</option>
                        </select>
                    </div>

                    <div class="setting-group">
                        <label for="survival-language">Language</label>
                        <select id="survival-language" tabindex="-1">
                            <option value="english" selected>English</option>
                            <option value="bangla">Bangla</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="mode-settings" id="practice-settings">
                <div class="ai-practice">
                    <h3>AI-Powered Practice</h3>
                    <p>
                        Based on your previous performance, we recommend practicing these
                        areas:
                    </p>
                    <div id="ai-suggestions">
                        <!-- AI suggestions will appear here -->
                    </div>
                    <button id="start-practice" tabindex="-1">
                        Start Practice Session
                    </button>
                </div>
            </div>

            <div class="mode-settings" id="prediction-settings">
                <div class="prediction-challenge">
                    <h3>Prediction Challenge</h3>
                    <p>Type ahead of AI predictions for bonus points!</p>
                    <div class="prediction-text" id="prediction-text">
                        <!-- Prediction text will appear here -->
                    </div>
                    <button id="start-prediction" tabindex="-1">Start Challenge</button>
                </div>
            </div>

            <div class="setting-group">
                <button id="apply-settings" tabindex="-1">Apply Settings</button>
                <button id="keyboard-remap" tabindex="-1" class="secondary">
                    Remap Keyboard
                </button>
                <button id="one-handed-mode" tabindex="-1" class="secondary">
                    One-Handed Mode
                </button>
            </div>
        </div>

        <div class="test-area">
            <div class="timer" id="timer">60</div>

            <div class="words-container" id="words-container">
                <!-- Words will be generated here -->
            </div>

            <div class="input-area">
                <input type="text" id="typing-input" placeholder="Click here or press Tab to start typing..."
                    autocomplete="off" tabindex="0" />

                <!-- On-screen keyboard -->
                <div class="on-screen-keyboard" id="on-screen-keyboard">
                    <!-- Keyboard will be generated here -->
                </div>

                <!-- Mobile keyboard for swipe support -->
                <div class="mobile-keyboard" id="mobile-keyboard">
                    <!-- Mobile keyboard will be generated here -->
                </div>
            </div>

            <div class="sound-toggle">
                <label for="sound-toggle">Sound: </label>
                <input type="checkbox" id="sound-toggle" checked />
                <select id="sound-type">
                    <option value="mechanical">Mechanical</option>
                    <option value="typewriter">Typewriter</option>
                    <option value="asmr">ASMR</option>
                </select>
            </div>

            <button id="reset-test" class="primary" style="margin-top: 1rem; width: auto; padding: 0.5rem 1rem"
                tabindex="-1">
                Reset Test
            </button>
            <button id="show-tutorial" class="secondary" style="margin-top: 1rem; width: auto; padding: 0.5rem 1rem"
                tabindex="-1">
                Show Tutorial
            </button>
        </div>

        <div class="stats-panel">
            <div class="stats-grid">
                <div class="stat">
                    <div class="stat-value" id="wpm">0</div>
                    <div class="stat-label">Words Per Minute</div>
                </div>

                <div class="stat">
                    <div class="stat-value" id="accuracy">100%</div>
                    <div class="stat-label">Accuracy</div>
                </div>

                <div class="stat">
                    <div class="stat-value" id="keystrokes">0</div>
                    <div class="stat-label">Keystrokes</div>
                </div>

                <div class="stat">
                    <div class="stat-value" id="errors">0</div>
                    <div class="stat-label">Errors</div>
                </div>
            </div>

            <!-- Progress Chart -->
            <div class="progress-chart" id="progress-chart">
                <canvas id="wpm-chart"></canvas>
            </div>
        </div>

        <div class="ai-analysis">
            <h3>ðŸ¤– AI Analysis</h3>
            <div class="analysis-content" id="analysis-content">
                Complete a test to get personalized feedback on your typing
                performance.
            </div>

            <div class="heatmap-container" id="heatmap-container" style="display: none">
                <div class="heatmap-title">Key Heatmap</div>
                <div class="heatmap-keys" id="heatmap-keys">
                    <!-- Heatmap will be generated here -->
                </div>
            </div>

            <div class="error-breakdown" id="error-breakdown" style="display: none">
                <div class="heatmap-title">Error Breakdown</div>
                <div id="error-list">
                    <!-- Error breakdown will be generated here -->
                </div>
            </div>

            <!-- Finger Placement Tutor -->
            <div class="finger-tutor" id="finger-tutor" style="display: none">
                <h3>Finger Placement Guide</h3>
                <p>
                    Proper finger placement can improve your typing speed and accuracy
                </p>
                <div class="hand-diagram">
                    <div class="hand">
                        <div class="finger" style="background: #f72585">Pinky</div>
                        <div class="finger" style="background: #f77f00">Ring</div>
                        <div class="finger" style="background: #4cc9f0">Middle</div>
                        <div class="finger" style="background: #4361ee">Index</div>
                        <div class="finger" style="background: #3a0ca3">Thumb</div>
                    </div>
                    <div class="hand">
                        <div class="finger" style="background: #4361ee">Index</div>
                        <div class="finger" style="background: #4cc9f0">Middle</div>
                        <div class="finger" style="background: #f77f00">Ring</div>
                        <div class="finger" style="background: #f72585">Pinky</div>
                        <div class="finger" style="background: #3a0ca3">Thumb</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Community Features -->
        <div class="ai-analysis">
            <h3>ðŸ‘¥ Community & Achievements</h3>

            <!-- Weekly Leaderboard -->
            <div class="leaderboard">
                <h4>Weekly Leaderboard</h4>
                <div id="leaderboard-list">
                    <!-- Leaderboard will be generated here -->
                </div>
            </div>

            <!-- User Achievements -->
            <div class="achievements">
                <h4>Your Achievements</h4>
                <div id="achievements-list">
                    <!-- Achievements will be generated here -->
                </div>
            </div>

            <!-- Share Results -->
            <div style="margin-top: 1rem">
                <button id="share-results" tabindex="-1">Share Your Results</button>
            </div>
        </div>

        <footer>
            <p>
                TypeMaster || Created by Taafeef Bin Montaquim
            <p>Visit my other websites:
                <a href="https://taskschedulepro.netlify.app/" id="privacy-link" tabindex="-1">Task Schedule Pro</a>
                <a href="https://weatherify-ai.netlify.app/">Weatherify AI</a>
            </p>
            </p>
        </footer>
    </div>

    <!-- Firebase Configuration -->
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBUM8QweWGD3t0ksNs_nf8u-uhxFMZDrc8",
            authDomain: "typemaster-ai.firebaseapp.com",
            databaseURL: "https://typemaster-ai-default-rtdb.firebaseio.com",
            projectId: "typemaster-ai",
            storageBucket: "typemaster-ai.firebasestorage.app",
            messagingSenderId: "836500969709",
            appId: "1:836500969709:web:fb913fe69c4aba8695d4e4",
            measurementId: "G-MZPN6ETQL7"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Initialize Google Auth Provider
        const googleProvider = new firebase.auth.GoogleAuthProvider();
    </script>

    <!-- Main Application Script -->
    <script src="script.js"></script>
</body>

</html>